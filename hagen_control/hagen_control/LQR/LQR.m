close all

x0 = [1;
      1;
      1.4];

A = [ 1.00000000e+00  0.00000000e+00 -1.97089946e-03;
      0.00000000e+00  1.00000000e+00  3.39934286e-04;
      0.00000000e+00  0.00000000e+00  1.00000000e+00];

B = [0.00033993 0.0;
     0.0019709 0.0;
     0.0 0.002];

C = diag([1,1,1]);
D = [0 0;
     0 0;
     0 0];

Q = diag([2,2,2]);
R = diag([0.1,0.1]);

K = lqr(A, B, Q, R);


sys = ss((A-B*K), B, C, D);

t = 0:0.005:30;

[y, t, x] = initial(sys, x0, t);

plot(t, y(:,1))
hold on
plot(t, y(:,2))
% hold on
% plot(t, y(:,3))

